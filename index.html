<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpotiVibe - Find Your Vibie's Sound</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #141414;
            --bg-card-hover: #1a1a1a;
            --accent-pink: #ff3366;
            --accent-purple: #9945ff;
            --accent-blue: #14f195;
            --accent-cyan: #00d4ff;
            --text-primary: #ffffff;
            --text-secondary: #888888;
            --text-muted: #555555;
            --border-subtle: rgba(255,255,255,0.08);
            --border-accent: rgba(255,51,102,0.3);
            --gradient-main: linear-gradient(135deg, #ff3366 0%, #9945ff 50%, #14f195 100%);
        }

        body {
            min-height: 100vh;
            background: var(--bg-dark);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            color: var(--text-primary);
            line-height: 1.6;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 50px;
        }

        .logo {
            font-size: 3rem;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 12px;
            letter-spacing: -0.02em;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 400;
        }

        /* Search Section */
        .search-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
        }

        .search-inner {
            display: flex;
            gap: 16px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .input-wrapper {
            position: relative;
        }

        .search-input {
            background: rgba(255,255,255,0.05);
            border: 2px solid var(--border-subtle);
            border-radius: 12px;
            padding: 16px 24px;
            font-size: 1.1rem;
            color: var(--text-primary);
            font-family: inherit;
            width: 200px;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            border-color: var(--accent-pink);
            background: rgba(255,51,102,0.05);
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-btn {
            background: var(--gradient-main);
            border: none;
            border-radius: 12px;
            padding: 16px 36px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(255,51,102,0.3);
        }

        .search-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .status-text {
            text-align: center;
            margin-top: 16px;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .error-text {
            color: var(--accent-pink);
        }

        /* Results */
        .results {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .results.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-grid {
            display: grid;
            grid-template-columns: 320px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 800px) {
            .results-grid { grid-template-columns: 1fr; }
        }

        /* NFT Card */
        .nft-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            overflow: hidden;
        }

        .nft-image-wrapper {
            position: relative;
            aspect-ratio: 1;
            background: linear-gradient(135deg, rgba(255,51,102,0.1), rgba(153,69,255,0.1));
        }

        .nft-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .nft-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
        }

        .nft-info {
            padding: 20px;
        }

        .nft-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .traits-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .trait-item {
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            padding: 10px;
        }

        .trait-label {
            font-size: 0.65rem;
            color: var(--accent-cyan);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 2px;
        }

        .trait-value {
            font-size: 0.8rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        /* Vibe Card */
        .vibe-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 30px;
        }

        .section-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: 20px;
        }

        .vibe-badges {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 30px;
        }

        @media (max-width: 500px) {
            .vibe-badges { grid-template-columns: 1fr; }
        }

        .vibe-badge {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 16px;
            background: rgba(255,255,255,0.02);
            border: 1px solid var(--border-subtle);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .vibe-badge:hover {
            background: rgba(255,255,255,0.05);
            border-color: var(--border-accent);
        }

        .vibe-emoji {
            font-size: 1.8rem;
        }

        .vibe-name {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .vibe-desc {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        /* Reading */
        .reading-box {
            background: linear-gradient(135deg, rgba(255,51,102,0.05), rgba(153,69,255,0.05));
            border: 1px solid var(--border-accent);
            border-radius: 16px;
            padding: 24px;
        }

        .reading-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            color: var(--accent-pink);
            font-weight: 600;
            font-size: 0.85rem;
        }

        .reading-text {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.7;
        }

        /* Genre Section */
        .genre-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: 20px;
            padding: 30px;
        }

        .genre-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .genre-primary {
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient-main);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .genre-secondary {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .genre-tag {
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
        }

        .playlist-info {
            background: rgba(255,255,255,0.02);
            border-radius: 12px;
            padding: 16px 20px;
            margin-bottom: 20px;
        }

        .playlist-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 4px;
        }

        .playlist-name {
            font-weight: 600;
            color: var(--text-primary);
        }

        .playlist-reason {
            font-size: 0.85rem;
            color: var(--text-secondary);
            margin-top: 8px;
        }

        .spotify-embed {
            border-radius: 12px;
            overflow: hidden;
        }

        .spotify-embed iframe {
            border-radius: 12px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        .footer-brand {
            color: var(--accent-cyan);
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="logo">SpotiVibe</h1>
            <p class="tagline">Discover your Vibie's unique sound DNA</p>
        </header>

        <div class="search-card">
            <div class="search-inner">
                <div class="input-wrapper">
                    <input type="number" id="gvcInput" class="search-input" placeholder="GVC # (1-6969)">
                </div>
                <button id="searchBtn" class="search-btn">Analyze Vibes</button>
            </div>
            <p id="statusText" class="status-text" style="display: none;"></p>
            <p id="errorText" class="status-text error-text" style="display: none;"></p>
        </div>

        <div id="results" class="results">
            <div class="results-grid">
                <div class="nft-card">
                    <div class="nft-image-wrapper">
                        <img id="nftImage" class="nft-image" style="display: none;" alt="GVC NFT">
                        <div id="nftPlaceholder" class="nft-placeholder">ðŸ¤™</div>
                    </div>
                    <div class="nft-info">
                        <h2 id="nftTitle" class="nft-title"></h2>
                        <div id="traitsGrid" class="traits-grid"></div>
                    </div>
                </div>

                <div class="vibe-card">
                    <div class="section-title">Vibe DNA</div>
                    <div id="vibeBadges" class="vibe-badges"></div>
                    
                    <div class="reading-box">
                        <div class="reading-header">
                            <span>ðŸ”®</span>
                            <span>The Reading</span>
                        </div>
                        <p id="vibeReading" class="reading-text"></p>
                    </div>
                </div>
            </div>

            <div class="genre-card">
                <div class="section-title">Your Sound</div>
                <div class="genre-display">
                    <span id="genrePrimary" class="genre-primary"></span>
                    <div id="genreSecondary" class="genre-secondary"></div>
                </div>
                
                <div class="playlist-info">
                    <div class="playlist-label">Now Playing</div>
                    <div id="playlistName" class="playlist-name"></div>
                    <p id="playlistReason" class="playlist-reason"></p>
                </div>

                <div id="spotifyEmbed" class="spotify-embed"></div>
            </div>
        </div>

        <footer class="footer">
            Powered by <span class="footer-brand">Dorticus Maximus</span> ðŸ¤™
        </footer>
    </div>

    <script>
        const GVC_CONTRACT = '0xB8Ea78fcaCEf50d41375E44E6814ebbA36Bb33c4';
        const ALCHEMY_API_KEY = '0M49GC5sazH-O5qUtGdKL';

        // VIBE CATEGORIES
        const VIBE_CATEGORIES = {
            firedUp: { name: 'Fired Up', emoji: 'ðŸ”¥', color: '#ff3366', desc: 'High intensity' },
            sunshine: { name: 'Sunshine', emoji: 'â˜€ï¸', color: '#ffcc00', desc: 'Bright & uplifting' },
            zoomIn: { name: 'Zoom In', emoji: 'âš¡', color: '#ff9900', desc: 'Fast & driven' },
            soChill: { name: 'So Chill', emoji: 'ðŸ§Š', color: '#00d4ff', desc: 'Relaxed & easy' },
            throwback: { name: 'Throwback', emoji: 'ðŸ“¼', color: '#9945ff', desc: 'Nostalgic vibes' },
            vibeOut: { name: 'Vibe Out', emoji: 'ðŸŒŠ', color: '#14f195', desc: 'Flowy & dreamy' },
            drip: { name: 'Drip', emoji: 'ðŸ’Ž', color: '#bc3fbc', desc: 'Luxe & premium' }
        };

        // GENRE DATABASE - Each genre has 15-25 playlists
        const GENRE_PLAYLISTS = {
            'Hip-Hop': [
                { id: '37i9dQZF1DX0XUsuxWHRQd', name: 'RapCaviar' },
                { id: '37i9dQZF1DWY4xHQp97fN6', name: 'Get Turnt' },
                { id: '37i9dQZF1DX2RxBh64BHjQ', name: 'Most Lit' },
                { id: '37i9dQZF1DWT5MrZnPU1zD', name: 'Most Necessary' },
                { id: '37i9dQZF1DX6GwdWRQMQpq', name: 'Gold School' },
                { id: '37i9dQZF1DWTggY0yqBxES', name: 'Mellow Bars' },
                { id: '37i9dQZF1DX9oh43oAzkyx', name: 'Bars & Beats' },
                { id: '37i9dQZF1DX7Mq3mO5SThc', name: 'Hip-Hop Controller' },
                { id: '37i9dQZF1DX186v583rmzp', name: 'Workout Hip-Hop' },
                { id: '37i9dQZF1DX2sQHbtx0sdt', name: 'Global Hip-Hop' },
                { id: '4RZdbJh7v5Xhuks7rHmFIx', name: 'Underground Rap 2026' },
                { id: '2Lckccw0IUNpLkKINnAfm4', name: 'Best Underground Hip Hop' },
                { id: '37i9dQZF1DX0SM0LYsmbMT', name: 'Jazz Rap' },
                { id: '37i9dQZF1DX48TTZL62Yht', name: 'Hip-Hop Drive' },
                { id: '37i9dQZF1DWUraJYejk11q', name: 'Get Lit' }
            ],
            'R&B': [
                { id: '37i9dQZF1DX4SBhb3fqCJd', name: 'Are & Be' },
                { id: '37i9dQZF1DWYmmr74INQlb', name: 'R&B Favourites' },
                { id: '37i9dQZF1DX6VDO8a6cQME', name: 'Chill R&B' },
                { id: '37i9dQZF1DWXnexX7CktaI', name: '90s R&B' },
                { id: '37i9dQZF1DX2UgsUIg75Vg', name: 'Good Vibes' },
                { id: '37i9dQZF1DX7FY5ma9PVot', name: 'Neo Soul' },
                { id: '37i9dQZF1DX1MUPbVKMgJE', name: 'Mood Booster R&B' },
                { id: '37i9dQZF1DXbr8F9M5JaDi', name: 'R&B Workout' },
                { id: '37i9dQZF1DX0hvSv9Rf41p', name: 'R&B Now' },
                { id: '37i9dQZF1DX4y8h9WqDPAE', name: 'Feelin Good' },
                { id: '37i9dQZF1DWVzZlRWgqAGH', name: 'Timeless Love Songs' },
                { id: '37i9dQZF1DWTbzY5gOVvKd', name: 'Bedroom Jams' },
                { id: '37i9dQZF1DX7Jl5KP2eZaS', name: 'New Jack Swing' }
            ],
            'Electronic': [
                { id: '37i9dQZF1DX4dyzvuaRJ0n', name: 'mint' },
                { id: '37i9dQZF1DX0BcQWzuB7ZO', name: 'Dance Hits' },
                { id: '37i9dQZF1DX4eRPd9frC1m', name: 'Housewerk' },
                { id: '37i9dQZF1DX5Q27plkaOQ3', name: 'Night Rider' },
                { id: '6vDGVr652ztNWKZuHvsFvx', name: 'Deep House 2026' },
                { id: '3QEYvCsVXZj8KuzE0bDmcI', name: 'Techno & Tech House' },
                { id: '0SOh8gmKbBBTIlFC0cV06F2', name: 'Deep House Playlist' },
                { id: '6vcnm2ksrLpEGKMk9Kzuyp', name: 'Melodic House & Techno' },
                { id: '37i9dQZF1DX6J5NfMJS675', name: 'Techno Bunker' },
                { id: '37i9dQZF1DX8tZsk68tuDw', name: 'Night Bass' },
                { id: '37i9dQZF1DX1kCIzMYtzum', name: 'Dance Party' },
                { id: '37i9dQZF1DX0r3x8OtiwEM', name: 'Bass Face' },
                { id: '37i9dQZF1DXaXB8fQg7xif', name: 'Dance Rising' },
                { id: '37i9dQZF1DWYAcBZSAVhlf', name: 'Night Visions' }
            ],
            'Lo-Fi': [
                { id: '37i9dQZF1DWWQRwui0ExPn', name: 'Lofi Beats' },
                { id: '0vvXsWCC9xrXsKd4FyS8kM', name: 'Lofi Girl' },
                { id: '37i9dQZF1DX8Uebhn9wzrS', name: 'Chill Lofi Study' },
                { id: '74sUjcvpGfdOvCHvgzNEDO', name: 'Lofi Hip Hop Focus' },
                { id: '3LFIBdP7eZXJKqf3guepZ1', name: 'Lofi Fruits' },
                { id: '37i9dQZF1DX3rxVfibe1L0', name: 'Peaceful Meditation' },
                { id: '37i9dQZF1DX6ziVCJnEm59', name: 'Calming Down' },
                { id: '37i9dQZF1DX4WYpdgoIcn6', name: 'Chill Hits' },
                { id: '37i9dQZF1DX9sIqqvKsjG8', name: 'Deep Focus' },
                { id: '37i9dQZF1DWZeKCadgRdKQ', name: 'Deep Sleep' },
                { id: '37i9dQZF1DX8ymr6UES7vc', name: 'Morning Motivation' },
                { id: '37i9dQZF1DX0h0QnLkMBl4', name: 'Sleep Chill' }
            ],
            'Rock': [
                { id: '37i9dQZF1DXcF6B6QPhFDv', name: 'Rock This' },
                { id: '37i9dQZF1DWXRqgorJj26U', name: 'Rock Classics' },
                { id: '37i9dQZF1DX1rVvRgjX59F', name: 'Hard Rock' },
                { id: '37i9dQZF1DX9wa6XirBPv8', name: 'Rock Party' },
                { id: '37i9dQZF1DWWJOmJ7nRx0C', name: '00s Rock Anthems' },
                { id: '37i9dQZF1DX3oM43CtKnRV', name: 'Classic Rock Workout' },
                { id: '37i9dQZF1DX82pCGH5USnM', name: 'New Core' },
                { id: '37i9dQZF1DX1lVhptIYRda', name: 'Rock Drive' },
                { id: '37i9dQZF1DWXNFSTtym834', name: 'Soft Rock' },
                { id: '37i9dQZF1DX4uPi2GIz1pT', name: 'Ultimate Indie Rock' },
                { id: '37i9dQZF1DX09mDLCBvWBt', name: 'Southern Rock' },
                { id: '37i9dQZF1DX5HvXdpOOQtp', name: '70s Rock' }
            ],
            'Jazz': [
                { id: '37i9dQZF1DXbITWG1ZJKYt', name: 'Jazz Classics' },
                { id: '37i9dQZF1DWTR4ZOXTfd9K', name: 'Blue Note' },
                { id: '37i9dQZF1DX4wta20PHgwo', name: 'Late Night Jazz' },
                { id: '37i9dQZF1DXdwTUxmGKrdN', name: 'Jazz Chill' },
                { id: '37i9dQZF1DX0SM0LYsmbMT', name: 'Jazz Rap' },
                { id: '37i9dQZF1DX7YCknf2jT6s', name: 'Coffee Shop Jazz' },
                { id: '37i9dQZF1DWVqfgj8NZEp1', name: 'Coffee Table Jazz' },
                { id: '37i9dQZF1DX2vYju3i0lNX', name: 'Jazz for Sleep' },
                { id: '37i9dQZF1DX1N5uK98ms5p', name: 'Vocal Jazz' },
                { id: '37i9dQZF1DWVtBrCfhXb3h', name: 'Jazz Piano' },
                { id: '37i9dQZF1DX5jkvar30HjL', name: 'Smooth Jazz' }
            ],
            'Funk': [
                { id: '37i9dQZF1DX70TzPK5buVf', name: 'Funk Outta Here' },
                { id: '37i9dQZF1DXaKIA8E7WcJj', name: 'Disco Forever' },
                { id: '37i9dQZF1DX3oHGT11Ov4F', name: 'Nu Disco' },
                { id: '37i9dQZF1DX6GJXiuZRisr', name: '80s Hits' },
                { id: '37i9dQZF1DWTJ7xPn4vNaz', name: 'All Out 70s' },
                { id: '37i9dQZF1DX4UtSsGT1Sbe', name: 'Pop Synth' },
                { id: '37i9dQZF1DXdLEN7aqioXM', name: 'Synthwave' },
                { id: '37i9dQZF1DWTcqUzwhNmKv', name: 'Funk & Soul Classics' },
                { id: '37i9dQZF1DX2H2NU4nZsOd', name: 'Boogie Night' },
                { id: '37i9dQZF1DX8WMG8VPSGJF', name: 'Country Funk' },
                { id: '37i9dQZF1DX8ymr6UES7vc', name: 'Funk Hour' }
            ],
            'Pop': [
                { id: '37i9dQZF1DXarRysLJmuju', name: 'Feel Good Pop' },
                { id: '37i9dQZF1DX2A29LI7xHn1', name: 'Pop Sauce' },
                { id: '37i9dQZF1DX5Ejj0EkURtP', name: 'Pop Rising' },
                { id: '37i9dQZF1DX4JAvHpjipBk', name: 'New Music Friday' },
                { id: '37i9dQZF1DX3MU5XUozve7', name: 'Summer Hits' },
                { id: '37i9dQZF1DWV7EzJMK2FUI', name: 'Pop Hits' },
                { id: '37i9dQZF1DX7iB3RCnBnN4', name: 'Happy Pop' },
                { id: '37i9dQZF1DX8FwQ2yH2b0B', name: 'Power Workout' },
                { id: '37i9dQZF1DXdPec7aLTmlC', name: 'Happy Hits' },
                { id: '37i9dQZF1DX0UrRvztWcAU', name: 'Pumped Pop' },
                { id: '37i9dQZF1DX4WYpdgoIcn6', name: 'Chill Pop' },
                { id: '37i9dQZF1DXaXRkxCuRRge', name: '2010s Pop' }
            ],
            'Latin': [
                { id: '37i9dQZF1DX10zKzsJ2jva', name: 'Viva Latino' },
                { id: '37i9dQZF1DX8j6ESAQb15J', name: 'Baila Reggaeton' },
                { id: '37i9dQZF1DX1HCSfq0nSal', name: 'La Vida' },
                { id: '37i9dQZF1DWY7IeIP1cdjF', name: 'Bachata Lovers' },
                { id: '37i9dQZF1DX5Ejj0EkURtP', name: 'Latin Pop Rising' },
                { id: '37i9dQZF1DWVgMUsHLnuzb', name: 'Salsa Clasica' },
                { id: '37i9dQZF1DXbLMw3ry7d7k', name: 'Latin Trap' },
                { id: '37i9dQZF1DX7c0dEbU7MV7', name: 'Perreo Puro' },
                { id: '37i9dQZF1DWULoCCCDlSTX', name: 'Regional Mexicano' },
                { id: '37i9dQZF1DX8SfyqmSFDwe', name: 'Latin Hits' },
                { id: '37i9dQZF1DX7SeoIaFyTmP', name: 'Pa La Fiesta' }
            ],
            'Afrobeats': [
                { id: '37i9dQZF1DWYkaDif7Ztbp', name: 'Afrobeats Hits' },
                { id: '37i9dQZF1DWYs2pvwxWA7l', name: 'African Heat' },
                { id: '37i9dQZF1DX7MmacNLmXRO', name: 'Afropop' },
                { id: '37i9dQZF1DXbnzM4wZ6I2M', name: 'Amapiano Lifestyle' },
                { id: '37i9dQZF1DX4GGhDdidFNR', name: 'New Afro Nation' },
                { id: '37i9dQZF1DX7F4bvMpLjRL', name: 'Afro Hub' },
                { id: '37i9dQZF1DWUjlhEQmZkyk', name: 'African Morning' },
                { id: '37i9dQZF1DX8W3mJhGbC04', name: 'Afro Workout' },
                { id: '37i9dQZF1DX3K8IJ6D8BHH', name: 'Afro Romance' },
                { id: '37i9dQZF1DXclZMJQIAOY0', name: 'Dancehall Queen' }
            ],
            'Indie': [
                { id: '37i9dQZF1DX2Nc3B70tvx0', name: 'Indie All-Stars' },
                { id: '37i9dQZF1DXdbXrPNafg9d', name: 'Indie Pop' },
                { id: '37i9dQZF1DX2sUQwD7tbmL', name: 'Pollen' },
                { id: '37i9dQZF1DX4pbGJDhTXK3', name: 'Lorem' },
                { id: '37i9dQZF1DX873GaRGUmPl', name: 'Alternative 90s' },
                { id: '37i9dQZF1DXdLEN7aqioXM', name: 'Synthwave' },
                { id: '37i9dQZF1DX5OUTmBMF3Ym', name: 'Bedroom Pop' },
                { id: '37i9dQZF1DXaE9W8PL8JYc', name: 'Undiscovered' },
                { id: '37i9dQZF1DX6aTaZa0K6VA', name: 'Fresh Finds' },
                { id: '37i9dQZF1DX4OzrY981I1W', name: 'Melancholia' },
                { id: '37i9dQZF1DWUE76cNNotSg', name: 'Indie Roadtrip' }
            ],
            'Reggae': [
                { id: '37i9dQZF1DXbSbnqxMTGx9', name: 'Reggae Classics' },
                { id: '37i9dQZF1DX2oc5aN4UDfD', name: 'Ultimate Reggae' },
                { id: '37i9dQZF1DXan38dNVDdl4', name: 'Island Reggae' },
                { id: '37i9dQZF1DX7HcRDRAqiUf', name: 'Reggae Chillin' },
                { id: '37i9dQZF1DWVtBrCfhXb3h', name: 'Reggae Instrumental' },
                { id: '37i9dQZF1DXclZMJQIAOY0', name: 'Dancehall Queen' },
                { id: '37i9dQZF1DX8SfyqmSFDwe', name: 'Caribbean Vibes' },
                { id: '37i9dQZF1DX8yYcySfFRZv', name: 'Roots Reggae' },
                { id: '37i9dQZF1DX1HUbZS4LEyL', name: 'Reggae Sunshine' }
            ],
            'Metal': [
                { id: '37i9dQZF1DWZryfp6NSvtz', name: 'Kickass Metal' },
                { id: '37i9dQZF1DX9qNs32fujYe', name: 'Heavy Metal' },
                { id: '37i9dQZF1DX5J7FIl4q56G', name: 'All New Metal' },
                { id: '37i9dQZF1DX8wtrGlXjDVw', name: 'Nu Metal Generation' },
                { id: '37i9dQZF1DWWPaoAJgSGnb', name: 'Heavy Queens' },
                { id: '37i9dQZF1DX4VlXF5qMpFX', name: 'Metalcore' },
                { id: '37i9dQZF1DX5wa9BYH4ODP', name: 'Death Metal' },
                { id: '37i9dQZF1DX2LTcinqsO68', name: 'Power Metal' },
                { id: '37i9dQZF1DX4Qr42aBpggV', name: 'Headbangers Ball' },
                { id: '37i9dQZF1DX0HRj9P7NxeE', name: 'Metal Essentials' }
            ],
            'Punk': [
                { id: '37i9dQZF1DXd6tJtr4qeot', name: 'Punk Essentials' },
                { id: '37i9dQZF1DX0KpeLYvWM9r', name: 'Pop Punk Powerhouses' },
                { id: '37i9dQZF1DX3LDIBRoaCDQ', name: 'Skater XL' },
                { id: '37i9dQZF1DX1ewVhAJ17m4', name: 'Punk Unplugged' },
                { id: '37i9dQZF1DWZGxHjBmcXR2', name: 'Punk Classics' },
                { id: '37i9dQZF1DX34favBYc9Ch', name: 'Emo Forever' },
                { id: '37i9dQZF1DX9GRpeH4CL0S', name: 'Pop Punk' },
                { id: '37i9dQZF1DWTZpyEyBRh5J', name: 'Hardcore' },
                { id: '37i9dQZF1DX0mDLiEX5EpU', name: 'Punk Rock Workout' }
            ],
            'Classical': [
                { id: '37i9dQZF1DWWEJlAGA9gs0', name: 'Classical Essentials' },
                { id: '37i9dQZF1DX9G9wwzwWL2k', name: 'Epic Classical' },
                { id: '37i9dQZF1DX8NTLI2TtZa6', name: 'Peaceful Piano' },
                { id: '37i9dQZF1DX7K31D69s4M1', name: 'Intense Studying' },
                { id: '37i9dQZF1DWVvXA824aCbn', name: 'Ambient Relaxation' },
                { id: '37i9dQZF1DX561TxkByKxB', name: 'Classical Focus' },
                { id: '37i9dQZF1DX4sWSpwq3LiO', name: 'Peaceful Piano' },
                { id: '37i9dQZF1DX1YPTAhwehac', name: 'Classical Sleep' },
                { id: '37i9dQZF1DWV0gynK7G6pD', name: 'Cello Masterpieces' }
            ],
            'K-Pop': [
                { id: '37i9dQZF1DX9tPFwDMOaN1', name: 'K-Pop ON!' },
                { id: '37i9dQZF1DX4FcAKI5Nhzq', name: 'K-Pop Daebak' },
                { id: '37i9dQZF1DX5OepaGriAIm', name: 'K-Pop Rising' },
                { id: '37i9dQZF1DX9vYRBO9gjDe', name: 'This is BTS' },
                { id: '37i9dQZF1DX7jGZjyDa8rI', name: 'This is BLACKPINK' },
                { id: '37i9dQZF1DX8TDukdQi8x7', name: 'K-Pop Workout' },
                { id: '37i9dQZF1DX0P7PzzKwEKl', name: 'K-Pop Ballads' },
                { id: '37i9dQZF1DX0bH2mLFVqB5', name: 'K-Pop X-tra' }
            ]
        };

        // TRAIT TO GENRE MAPPING
        // Maps specific trait keywords to likely genre preferences
        const TRAIT_GENRE_MAP = {
            // PUNK/ROCK vibes
            'Mohawk': ['Punk', 'Metal', 'Rock'],
            'Leather': ['Rock', 'Metal', 'Punk'],
            'Eyepatch': ['Metal', 'Punk', 'Rock'],
            'Knight': ['Metal', 'Classical', 'Rock'],
            'Armor': ['Metal', 'Rock', 'Classical'],
            'Jagged': ['Punk', 'Metal', 'Rock'],
            
            // HIP-HOP vibes
            'Hoodie': ['Hip-Hop', 'R&B', 'Lo-Fi'],
            'Beanie': ['Hip-Hop', 'Indie', 'Lo-Fi'],
            'Ballcap': ['Hip-Hop', 'Pop', 'Rock'],
            'Tank': ['Hip-Hop', 'Electronic', 'Rock'],
            'Backwards': ['Hip-Hop', 'Rock', 'Punk'],
            
            // ELECTRONIC vibes
            'Robot': ['Electronic', 'K-Pop', 'Pop'],
            'Laser': ['Electronic', 'K-Pop', 'Pop'],
            'Visor': ['Electronic', 'K-Pop', 'Afrobeats'],
            'Helmet': ['Electronic', 'Metal', 'Rock'],
            'Neon': ['Electronic', 'K-Pop', 'Pop'],
            'Holographic': ['Electronic', 'K-Pop', 'Pop'],
            'Holo': ['Electronic', 'K-Pop', 'Pop'],
            'Cyber': ['Electronic', 'Metal', 'K-Pop'],
            'Gamer': ['Electronic', 'Hip-Hop', 'K-Pop'],
            
            // R&B/SOUL vibes
            'Slick': ['R&B', 'Jazz', 'Hip-Hop'],
            'Smooth': ['R&B', 'Jazz', 'Lo-Fi'],
            'Suit': ['Jazz', 'R&B', 'Classical'],
            'Turtleneck': ['Jazz', 'R&B', 'Indie'],
            
            // FUNK/RETRO vibes
            'Mullet': ['Funk', 'Rock', 'Indie'],
            'Afro': ['Funk', 'R&B', 'Afrobeats'],
            'Disco': ['Funk', 'Electronic', 'Pop'],
            '80s': ['Funk', 'Electronic', 'Pop'],
            'Retro': ['Funk', 'Rock', 'Indie'],
            'Windbreaker': ['Funk', 'Electronic', 'Hip-Hop'],
            'Boombox': ['Funk', 'Hip-Hop', 'Electronic'],
            'Stache': ['Funk', 'Rock', 'Indie'],
            
            // CHILL/LO-FI vibes
            'Mint': ['Lo-Fi', 'Jazz', 'Indie'],
            'Calm': ['Lo-Fi', 'Classical', 'Jazz'],
            'Meditation': ['Lo-Fi', 'Classical', 'Jazz'],
            'Cream': ['Lo-Fi', 'Jazz', 'R&B'],
            'Seafoam': ['Lo-Fi', 'Indie', 'Electronic'],
            'Library': ['Classical', 'Jazz', 'Lo-Fi'],
            
            // LATIN vibes
            'Orange': ['Latin', 'Afrobeats', 'Funk'],
            'Lime': ['Latin', 'Reggae', 'Afrobeats'],
            'Tropical': ['Reggae', 'Latin', 'Afrobeats'],
            
            // LUXURY/DRIP vibes
            'Gold': ['R&B', 'Hip-Hop', 'Jazz'],
            'Chrome': ['Electronic', 'Hip-Hop', 'K-Pop'],
            'Crown': ['Hip-Hop', 'R&B', 'Classical'],
            'Royal': ['Classical', 'R&B', 'Hip-Hop'],
            'Monocle': ['Jazz', 'Classical', 'Indie'],
            'Fur': ['R&B', 'Hip-Hop', 'Jazz'],
            
            // INDIE/ALTERNATIVE vibes
            'Gradient': ['Indie', 'Electronic', 'Lo-Fi'],
            'Glass': ['Indie', 'Classical', 'Electronic'],
            'Psychedelic': ['Indie', 'Rock', 'Funk'],
            'Cosmic': ['Indie', 'Electronic', 'Lo-Fi'],
            'Space': ['Electronic', 'Indie', 'Lo-Fi'],
            'Mystic': ['Indie', 'Electronic', 'Classical'],
            
            // REGGAE vibes
            'Bucket': ['Reggae', 'Hip-Hop', 'Indie'],
            'Dreadlocks': ['Reggae', 'Afrobeats', 'Hip-Hop'],
            
            // POP vibes
            'Pink': ['Pop', 'K-Pop', 'Electronic'],
            'Rainbow': ['Pop', 'K-Pop', 'Indie'],
            'Smile': ['Pop', 'K-Pop', 'Funk'],
            'Happy': ['Pop', 'K-Pop', 'Funk'],
            'Heart': ['Pop', 'K-Pop', 'R&B'],
            'Sunshine': ['Pop', 'Reggae', 'Funk'],
            'Candy': ['Pop', 'K-Pop', 'Electronic'],
            'Flower': ['Pop', 'Indie', 'Folk'],
            'Yellow': ['Pop', 'Funk', 'Reggae'],
            
            // AFROBEATS vibes
            'Jungle': ['Afrobeats', 'Electronic', 'Reggae'],
            'Pattern': ['Afrobeats', 'Funk', 'Latin'],
            
            // CLASSICAL/JAZZ vibes
            'Grayscale': ['Classical', 'Jazz', 'Lo-Fi'],
            'Stone': ['Classical', 'Metal', 'Jazz'],
            'Sculpture': ['Classical', 'Jazz', 'Indie'],
            'Unfinished': ['Classical', 'Jazz', 'Indie'],
            
            // K-POP vibes
            'Cute': ['K-Pop', 'Pop', 'Electronic'],
            'Wink': ['K-Pop', 'Pop', 'R&B'],
            
            // DEFAULT fallbacks for common traits
            'Black': ['Hip-Hop', 'Electronic', 'Metal'],
            'White': ['Pop', 'Classical', 'Electronic'],
            'Blue': ['Lo-Fi', 'Jazz', 'Electronic'],
            'Red': ['Rock', 'Latin', 'Hip-Hop'],
            'Purple': ['Electronic', 'R&B', 'Indie'],
            'Green': ['Reggae', 'Indie', 'Lo-Fi']
        };

        // Parse keywords from traits
        function parseKeywords(traitValue) {
            return traitValue
                .replace(/([a-z])([A-Z])/g, '$1 $2')
                .split(/[\s\-_]+/)
                .filter(w => w.length > 1);
        }

        // Determine genre based on traits
        function determineGenre(traits) {
            const genreVotes = {};
            
            // Initialize all genres
            Object.keys(GENRE_PLAYLISTS).forEach(g => genreVotes[g] = 0);
            
            // Go through all traits and accumulate genre votes
            traits.forEach(trait => {
                const keywords = parseKeywords(trait.value);
                keywords.forEach(keyword => {
                    const genres = TRAIT_GENRE_MAP[keyword];
                    if (genres) {
                        genres.forEach((genre, idx) => {
                            if (genreVotes[genre] !== undefined) {
                                // First choice gets 3 points, second gets 2, third gets 1
                                genreVotes[genre] += (3 - idx);
                            }
                        });
                    }
                });
            });
            
            // Sort genres by votes
            const sorted = Object.entries(genreVotes)
                .sort((a, b) => b[1] - a[1]);
            
            // Get top genre (must have at least some votes, otherwise default)
            const topGenre = sorted[0][1] > 0 ? sorted[0][0] : 'Pop';
            
            // Get secondary genres (2nd, 3rd, 4th)
            const secondaryGenres = sorted
                .slice(1, 4)
                .filter(([_, votes]) => votes > 0)
                .map(([genre]) => genre);
            
            return { primary: topGenre, secondary: secondaryGenres };
        }

        // Get random playlist from genre
        function getRandomPlaylist(genre) {
            const playlists = GENRE_PLAYLISTS[genre];
            if (!playlists || playlists.length === 0) {
                // Fallback to Pop
                return GENRE_PLAYLISTS['Pop'][Math.floor(Math.random() * GENRE_PLAYLISTS['Pop'].length)];
            }
            return playlists[Math.floor(Math.random() * playlists.length)];
        }

        // Calculate vibe scores for display
        function calculateVibes(traits) {
            const KEYWORD_VIBES = {
                'Mohawk': { firedUp: 40, zoomIn: 30 },
                'Leather': { firedUp: 30, drip: 20, throwback: 20 },
                'Red': { firedUp: 35, zoomIn: 20 },
                'Yellow': { sunshine: 40, firedUp: 20 },
                'Pink': { sunshine: 35, vibeOut: 20 },
                'Rainbow': { sunshine: 40, vibeOut: 25 },
                'Smile': { sunshine: 45, vibeOut: 15 },
                'Gold': { drip: 45, sunshine: 20 },
                'Chrome': { drip: 40, vibeOut: 20 },
                'Suit': { drip: 45, soChill: 20 },
                'Mint': { soChill: 40, vibeOut: 30 },
                'Calm': { soChill: 45, vibeOut: 35 },
                'Mullet': { throwback: 45, firedUp: 20 },
                '80s': { throwback: 45, firedUp: 20 },
                'Retro': { throwback: 45, vibeOut: 20 },
                'Robot': { zoomIn: 35, firedUp: 25 },
                'Laser': { zoomIn: 35, firedUp: 30 },
                'Cosmic': { vibeOut: 40, drip: 30 },
                'Glass': { vibeOut: 35, drip: 30 },
                'Holographic': { vibeOut: 35, drip: 35 },
                'Crown': { drip: 45, sunshine: 20 },
                'Royal': { drip: 45, throwback: 20 },
                'Hoodie': { firedUp: 20, soChill: 15 },
                'Beanie': { soChill: 20, throwback: 15 },
                'Afro': { throwback: 35, sunshine: 20 },
                'Space': { vibeOut: 35, zoomIn: 20 },
                'Meditation': { soChill: 50, vibeOut: 40 }
            };
            
            let scores = { firedUp: 50, sunshine: 50, zoomIn: 50, soChill: 50, throwback: 50, vibeOut: 50, drip: 50 };
            
            traits.forEach(trait => {
                const keywords = parseKeywords(trait.value);
                keywords.forEach(keyword => {
                    const vibes = KEYWORD_VIBES[keyword];
                    if (vibes) {
                        Object.keys(vibes).forEach(vibe => {
                            scores[vibe] += vibes[vibe];
                        });
                    }
                });
            });

            Object.keys(scores).forEach(k => {
                scores[k] = Math.max(10, Math.min(95, scores[k]));
            });

            return scores;
        }

        function getTopVibes(scores) {
            return Object.entries(scores)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 4)
                .map(([key]) => key);
        }

        function generateReading(topVibes, genre, traits) {
            const vibeNames = topVibes.map(v => VIBE_CATEGORIES[v].name);
            const allKeywords = traits.flatMap(t => parseKeywords(t.value));
            const colorWords = allKeywords.filter(w => ['Pink', 'Blue', 'Gold', 'Chrome', 'Red', 'Purple', 'Mint', 'Yellow', 'Rainbow', 'Black', 'White', 'Lime', 'Cosmic', 'Orange'].includes(w));
            const color = colorWords[0]?.toLowerCase() || 'unique';

            const genreDescriptions = {
                'Hip-Hop': 'This Vibie has serious street credibility and an undeniable swagger.',
                'R&B': 'Smooth, soulful, and dripping with emotionâ€”this Vibie feels the music.',
                'Electronic': 'Futuristic and high-energy, this Vibie belongs on the dance floor.',
                'Lo-Fi': 'Chill and introspective, this Vibie appreciates the mellow moments.',
                'Rock': 'Raw energy and authentic attitudeâ€”this Vibie was born to rock.',
                'Jazz': 'Sophisticated and smooth, this Vibie has impeccable taste.',
                'Funk': 'Groovy and timeless, this Vibie brings the party wherever they go.',
                'Pop': 'Bright, fun, and universally appealingâ€”this Vibie has mass appeal.',
                'Latin': 'Passionate and rhythmic, this Vibie moves with fire in their soul.',
                'Afrobeats': 'Vibrant and energetic, this Vibie carries global rhythms.',
                'Indie': 'Unique and artistic, this Vibie walks their own path.',
                'Reggae': 'Peaceful and positive, this Vibie spreads good vibes only.',
                'Metal': 'Intense and powerful, this Vibie doesnt hold back.',
                'Punk': 'Rebellious and authentic, this Vibie plays by their own rules.',
                'Classical': 'Refined and timeless, this Vibie appreciates the finer things.',
                'K-Pop': 'Polished and dynamic, this Vibie brings high production energy.'
            };

            return `${genreDescriptions[genre] || 'This Vibie has a unique sonic fingerprint.'} With strong ${vibeNames[0]} and ${vibeNames[1]} energy, complemented by ${vibeNames[2]} undertones, the ${color} aesthetic ties it all together perfectly.`;
        }

        // DOM
        const searchBtn = document.getElementById('searchBtn');
        const gvcInput = document.getElementById('gvcInput');
        const errorText = document.getElementById('errorText');
        const statusText = document.getElementById('statusText');
        const results = document.getElementById('results');

        gvcInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') searchBtn.click(); });
        searchBtn.addEventListener('click', fetchNFT);

        async function fetchNFT() {
            const id = parseInt(gvcInput.value);
            if (!id || id < 1 || id > 6969) {
                errorText.textContent = 'Please enter a valid GVC number (1-6969)';
                errorText.style.display = 'block';
                return;
            }

            searchBtn.disabled = true;
            searchBtn.textContent = 'Analyzing...';
            errorText.style.display = 'none';
            statusText.textContent = 'Fetching NFT data...';
            statusText.style.display = 'block';
            results.classList.remove('active');

            try {
                const url = `https://eth-mainnet.g.alchemy.com/nft/v3/${ALCHEMY_API_KEY}/getNFTMetadata?contractAddress=${GVC_CONTRACT}&tokenId=${id}&refreshCache=false`;
                const response = await fetch(url);
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                let imageUrl = data.image?.cachedUrl || data.image?.originalUrl || data.image?.pngUrl || data.raw?.metadata?.image || '';
                if (imageUrl.startsWith('ipfs://')) imageUrl = imageUrl.replace('ipfs://', 'https://ipfs.io/ipfs/');

                const traits = data.raw?.metadata?.attributes || [];
                const name = data.name || data.raw?.metadata?.name || `Good Vibes Club #${id}`;

                statusText.style.display = 'none';
                displayResults({ name, imageUrl, traits }, id);

            } catch (err) {
                console.error('Fetch error:', err);
                errorText.textContent = 'Failed to fetch NFT. Please try again.';
                errorText.style.display = 'block';
                statusText.style.display = 'none';
            } finally {
                searchBtn.disabled = false;
                searchBtn.textContent = 'Analyze Vibes';
            }
        }

        function displayResults(nftData, tokenId) {
            // Image
            const nftImage = document.getElementById('nftImage');
            const nftPlaceholder = document.getElementById('nftPlaceholder');
            
            if (nftData.imageUrl) {
                nftImage.src = nftData.imageUrl;
                nftImage.style.display = 'block';
                nftPlaceholder.style.display = 'none';
                nftImage.onerror = () => { nftImage.style.display = 'none'; nftPlaceholder.style.display = 'flex'; };
            } else {
                nftImage.style.display = 'none';
                nftPlaceholder.style.display = 'flex';
            }

            document.getElementById('nftTitle').textContent = nftData.name;

            // Traits
            const traitsGrid = document.getElementById('traitsGrid');
            traitsGrid.innerHTML = '';
            nftData.traits.forEach(trait => {
                const div = document.createElement('div');
                div.className = 'trait-item';
                div.innerHTML = `<div class="trait-label">${trait.trait_type}</div><div class="trait-value">${trait.value}</div>`;
                traitsGrid.appendChild(div);
            });

            // Calculate vibes
            const scores = calculateVibes(nftData.traits);
            const topVibes = getTopVibes(scores);

            // Display vibe badges
            const vibeBadges = document.getElementById('vibeBadges');
            vibeBadges.innerHTML = '';
            topVibes.forEach(vibeKey => {
                const vibe = VIBE_CATEGORIES[vibeKey];
                const div = document.createElement('div');
                div.className = 'vibe-badge';
                div.innerHTML = `
                    <div class="vibe-emoji">${vibe.emoji}</div>
                    <div>
                        <div class="vibe-name" style="color: ${vibe.color}">${vibe.name}</div>
                        <div class="vibe-desc">${vibe.desc}</div>
                    </div>
                `;
                vibeBadges.appendChild(div);
            });

            // Determine genre from traits
            const { primary: genre, secondary: secondaryGenres } = determineGenre(nftData.traits);
            
            // Get random playlist from that genre
            const playlist = getRandomPlaylist(genre);

            // Display genre
            document.getElementById('genrePrimary').textContent = genre;
            
            const secondaryContainer = document.getElementById('genreSecondary');
            secondaryContainer.innerHTML = '';
            secondaryGenres.forEach(g => {
                const tag = document.createElement('span');
                tag.className = 'genre-tag';
                tag.textContent = g;
                secondaryContainer.appendChild(tag);
            });

            // Display playlist
            document.getElementById('playlistName').textContent = playlist.name;
            
            const vibeNames = topVibes.slice(0, 2).map(v => VIBE_CATEGORIES[v].name);
            document.getElementById('playlistReason').textContent = 
                `Selected for your ${vibeNames[0]} + ${vibeNames[1]} energy profile`;

            // Generate reading
            const reading = generateReading(topVibes, genre, nftData.traits);
            document.getElementById('vibeReading').textContent = reading;

            // Embed playlist
            document.getElementById('spotifyEmbed').innerHTML = `
                <iframe src="https://open.spotify.com/embed/playlist/${playlist.id}?utm_source=generator&theme=0" 
                    width="100%" height="380" frameBorder="0" 
                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                    loading="lazy"></iframe>
            `;

            results.classList.add('active');
        }
    </script>
</body>
</html>
